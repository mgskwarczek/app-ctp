import tkinter as tk
from tkinter import filedialog
import matplotlib.pyplot as plt
from matplotlib.animation import FuncAnimation
import pandas as pd

class RealTimePlotApp:
    def __init__(self, root):
        self.root = root
        self.root.title("Real-Time Plot App")

        self.fig, self.ax = plt.subplots()
        self.line1, = self.ax.plot([], [], label='V1')
        self.line2, = self.ax.plot([], [], label='V2')
        self.ax.legend()

        self.pause = False

        self.canvas = FigureCanvasTkAgg(self.fig, master=self.root)
        self.canvas.get_tk_widget().pack(side=tk.TOP, fill=tk.BOTH, expand=1)

        self.toolbar = NavigationToolbar2Tk(self.canvas, self.root)
        self.toolbar.update()
        self.canvas.get_tk_widget().pack(side=tk.TOP, fill=tk.BOTH, expand=1)

        self.pause_button = tk.Button(self.root, text="Pause", command=self.toggle_pause)
        self.pause_button.pack()

        self.load_button = tk.Button(self.root, text="Load File", command=self.load_file)
        self.load_button.pack()

        self.animation = FuncAnimation(self.fig, self.update_plot, interval=100)

    def load_file(self):
        file_path = filedialog.askopenfilename(filetypes=[("Excel files", "*.xlsx")])
        if file_path:
            self.data = pd.read_excel(file_path)  # Wczytanie danych z pliku Excela

    def update_plot(self, frame):
        if hasattr(self, 'data') and not self.pause:
            self.line1.set_data(self.data['Time'], self.data['V1'])
            self.line2.set_data(self.data['Time'], self.data['V2'])
            self.ax.relim()
            self.ax.autoscale_view()
            return self.line1, self.line2

    def toggle_pause(self):
        self.pause = not self.pause
        if self.pause:
            self.pause_button.config(text="Resume")
        else:
            self.pause_button.config(text="Pause")

if __name__ == "__main__":
    root = tk.Tk()
    app = RealTimePlotApp(root)
    root.mainloop()
